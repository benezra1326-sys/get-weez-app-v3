# ü§ñ Configuration CodeRabbit pour Get Weez
# https://docs.coderabbit.ai/guides/review-instructions

# Configuration globale
language: fr
reviews:
  profile: chill  # Options: chill, assertive
  request_changes_workflow: false
  high_level_summary: true
  high_level_summary_placeholder: "## üéØ R√©sum√© de la Review\n\n"
  poem: true
  review_status: true
  collapse_level: 2
  filter_mode: diff_context
  auto_review:
    enabled: true
    drafts: false

# Instructions sp√©cifiques par chemin
path_instructions:
  - path: "**/*.js"
    instructions: |
      Concentre-toi sur :
      - Les bonnes pratiques Next.js et React
      - La gestion d'erreurs et l'exp√©rience utilisateur
      - La s√©curit√© des routes API et performance
      - Les fuites m√©moire potentielles dans les composants React
      - L'utilisation correcte des hooks React
      - La validation des donn√©es et types
  
  - path: "**/*.jsx" 
    instructions: |
      V√©rifie :
      - La structure des composants et validation des props
      - La conformit√© √† l'accessibilit√© (a11y)
      - Les principes de design responsive
      - La gestion d'√©tat appropri√©e
      - L'optimisation des re-rendus
      - La s√©paration des pr√©occupations
      
  - path: "components/chat/**"
    instructions: |
      Analyse sp√©cialement :
      - La fonctionnalit√© de chat et features temps r√©el
      - Les connexions WebSocket et gestion d'erreurs
      - Le traitement des messages et persistance d'√©tat
      - Les optimisations de performance pour mobile
      - L'int√©gration OpenAI et gestion des tokens
      - L'UX/UI pour chat mobile
      
  - path: "components/mobile/**"
    instructions: |
      Focus sur :
      - L'optimisation mobile et responsive design
      - Les performances sur appareils lents
      - La gestion des gestures et touch events  
      - L'accessibilit√© mobile
      - La compatibilit√© cross-browser mobile
      
  - path: "pages/api/**"
    instructions: |
      R√©vise attentivement :
      - La s√©curit√© API et authentification
      - La limitation de taux et validation d'entr√©e
      - Les op√©rations base de donn√©es et gestion d'erreurs
      - Les codes de statut HTTP appropri√©s
      - La performance des requ√™tes
      - La conformit√© RGPD/protection donn√©es
      
  - path: "**/*.css"
    instructions: |
      Examine :
      - Le design responsive et optimisation mobile
      - L'accessibilit√© dans les choix de style
      - Les probl√®mes de performance (gros fichiers, styles inutilis√©s)
      - L'utilisation coh√©rente du design system
      - La compatibilit√© cross-browser
      
  - path: "lib/**"
    instructions: |
      Contr√¥le :
      - La logique utilitaire et r√©utilisabilit√©
      - La gestion d'erreurs robuste
      - Les performances et optimisations
      - La s√©curit√© des fonctions sensibles
      - La documentation et types TypeScript
      
  - path: "hooks/**"
    instructions: |
      V√©rifie :
      - L'utilisation correcte des hooks React
      - La gestion des d√©pendances et effets
      - Les optimisations de performance
      - La r√©utilisabilit√© et composition
      - La gestion d'√©tat locale vs globale

# Instructions sp√©cifiques au domaine
knowledge_base:
  - |
    Get Weez est une application de conciergerie IA premium pour Marbella.
    Elle utilise Next.js, React, OpenAI API, et Supabase.
    L'accent est mis sur l'exp√©rience mobile et les performances.
    
  - |
    Architecture cl√© :
    - Frontend : Next.js avec React 18
    - Backend : API Routes Next.js
    - Base de donn√©es : Supabase (PostgreSQL)
    - IA : OpenAI GPT pour le chat
    - D√©ploiement : Vercel
    - Internationalisation : next-i18next
    
  - |
    Consid√©rations sp√©ciales :
    - Performance mobile critique
    - S√©curit√© API (cl√©s OpenAI, tokens)
    - UX/UI responsive et accessible
    - Optimisation pour march√© europ√©en (RGPD)

# Mod√®les de commentaires
chat:
  auto_reply: true
  
# Exclusions
ignore_paths:
  - "node_modules/**"
  - ".next/**"
  - "*.log"
  - "backups/**"
  - "*.md"  # Sauf pour les docs importantes

# R√®gles de review
rules:
  # JavaScript/React
  - pattern: "useState|useEffect"
    message: "V√©rifier que les hooks React sont utilis√©s correctement avec les d√©pendances appropri√©es"
    
  - pattern: "fetch\\("
    message: "Consid√©rer l'ajout de gestion d'erreurs et loading states pour les appels API"
    
  - pattern: "console\\.(log|warn|error)"
    message: "Les console.log doivent √™tre supprim√©s en production"
    
  - pattern: "process\\.env\\."
    message: "V√©rifier que les variables d'environnement sont correctement s√©curis√©es"
    
  # S√©curit√©
  - pattern: "dangerouslySetInnerHTML"
    message: "‚ö†Ô∏è Usage potentiellement dangereux - v√©rifier la sanitation des donn√©es"
    
  - pattern: "eval\\("
    message: "‚ùå eval() est dangereux et doit √™tre √©vit√©"

# Configuration des notifications
notifications:
  slack:
    webhook_url: ""  # √Ä configurer si n√©cessaire
  
# M√©triques et analytics
analytics:
  track_improvements: true
  generate_reports: true